select  misth_final_ypal_krat.kodkrat, misth_zpkrat.desckrat, misth_final.descfinal, misth_ypal.surname, misth_ypal.name, misth_ypal.fathername, misth_final.kodfinal, misth_final.datefinal, misth_final_ypal_krat.kodxrisi, misth_final_ypal_krat.poso, misth_final_ypal_krat.kodkratapod, misth_final_ypal.plirdate, misth_final.aa from misth_final_ypal_krat, misth_zpkrat, misth_final_ypal, misth_final, misth_ypal WHERE misth_final_ypal_krat.kodkrat = misth_zpkrat.kodkrat AND misth_final_ypal_krat.kodxrisi = misth_zpkrat.kodxrisi AND misth_final_ypal.kodfinal = misth_final_ypal_krat.kodfinal AND misth_final_ypal.kodypal = misth_final_ypal_krat.kodypal AND misth_final_ypal.kodxrisi = misth_final_ypal_krat.kodxrisi AND misth_final.kodfinal = misth_final_ypal.kodfinal AND misth_final.kodxrisi = misth_final_ypal.kodxrisi AND misth_ypal.kodypal = misth_final_ypal.kodypal AND misth_ypal.kodxrisi = misth_final_ypal.kodxrisi AND ( misth_final_ypal_krat.kodxrisi = :arg_kodxrisi and misth_final_ypal_krat.kodkratapod is null and misth_final_ypal.plirdate is not null  ) 