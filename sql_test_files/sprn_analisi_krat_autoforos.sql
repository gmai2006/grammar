select  misth_zpkrat.desckrat, misth_final_ypal_krat.kodkrat, misth_final_ypal_krat.kodxrisi, misth_final_ypal_krat.poso, sum(misth_final_ypal_krat.poso) as cm_sumposo from misth_final_ypal_krat, misth_zpkrat, misth_final_ypal WHERE misth_zpkrat.kodkrat = misth_final_ypal_krat.kodkrat AND misth_zpkrat.kodxrisi = misth_final_ypal_krat.kodxrisi AND misth_final_ypal.kodfinal = misth_final_ypal_krat.kodfinal AND misth_final_ypal.kodypal = misth_final_ypal_krat.kodypal AND misth_final_ypal.kodxrisi = misth_final_ypal_krat.kodxrisi AND ( misth_final_ypal_krat.kodypal = :arg_kodypal and misth_final_ypal_krat.kodxrisi = :arg_kodxrisi and misth_zpkrat.isautoforos = 1 and misth_zpkrat.isforos = 0 and misth_final_ypal.plirdate is not null  ) order by misth_zpkrat.desckrat ASC